<div class="section-card" id="form-gestion-card">
  <div class="section-header">
    <h2>Formulario de Gesti√≥n de Propuestas</h2>
    <button class="toggle-btn" data-target="#form-gestion-content" title="Mostrar/Ocultar Formulario">+</button>
  </div>

  <div class="section-content" id="form-gestion-content" style="display: none;">
    
    <div class="form-group" style="margin-bottom: 25px; text-align: center;">
      <label class="radio-check-label" for="tipoPropuestaNueva">
        <input type="radio" name="tipoPropuesta" value="nueva" id="tipoPropuestaNueva" class="radio-check-toggle" checked>
        <span class="radio-check-visual">‚úî</span>
        Nueva Propuesta
      </label>
      <label class="radio-check-label" for="tipoPropuestaMover">
        <input type="radio" name="tipoPropuesta" value="mover" id="tipoPropuestaMover" class="radio-check-toggle">
        <span class="radio-check-visual">‚úî</span>
        Mover Propuesta
      </label>
    </div>

    <div id="form-nueva-propuesta">
      <div class="form-row">
        <div class="form-group flex-1">
          <label for="nueva-titulo">T√≠tulo:</label>
          <input type="text" id="nueva-titulo" class="validate-me" placeholder="Ej: Mural de la Amistad">
        </div>
        <div class="form-group flex-1">
          <label for="nueva-coordenadas">Coordenadas (Originales):</label>
          <input type="text" id="nueva-coordenadas" class="geocode-trigger" placeholder="Ej: -12.045, -77.032">
        </div>
      </div>
      <div class="form-row">
        <div class="form-group flex-1">
          <label for="nueva-img">ID de Imagen (Opcional):</label>
          <input type="text" id="nueva-img" placeholder="Pegar URL completa o solo ID...">
        </div>
        <div class="form-group flex-1" style="align-self: center; padding-top: 15px;">
          <label class="check-label-button" for="nueva-reubicar-check">
            <input type="checkbox" id="nueva-reubicar-check" class="check-toggle">
            <span class="check-visual">‚úî</span>
            Sugerir reubicaci√≥n
          </label>
        </div>
      </div>
      <div class="form-row-reubicacion" id="fila-reubicacion" style="display: none; margin-top: 15px;">
        <div class="form-group flex-1">
          <label for="nueva-coordenadas-reubicadas">Coordenadas (Reubicacion):</label>
          <input type="text" id="nueva-coordenadas-reubicadas" readonly placeholder="Se rellenar√° desde el mapa...">
        </div>
        <button type="button" id="btn-ver-mapa-reubicacion" class="btn-ver-mapa">
          Ver Mapa
        </button>
      </div>
      <input type="hidden" id="nueva-direccion">
    </div>

    <div id="form-mover-propuesta" style="display: none;">
      <div class="form-row">
        <div class="form-group flex-1">
          <label for="mover-titulo">T√≠tulo:</label>
          <input type="text" id="mover-titulo" class="validate-me" placeholder="Ej: Estatua del Fundador">
        </div>
        <div class="form-group flex-1">
          <label for="mover-img">ID de Imagen (Opcional):</label>
          <input type="text" id="mover-img" placeholder="Pegar URL completa o solo ID...">
        </div>
      </div>
      <div class="form-row">
        <div class="form-group flex-1">
          <label for="mover-coor-actual">Coordenada Actual:</label>
          <input type="text" id="mover-coor-actual" class="validate-me geocode-trigger" placeholder="Ej: -12.045, -77.032">
        </div>
        <div class="form-group flex-1">
          <label for="mover-coor-modificada">Coordenada Modificada:</label>
          <input type="text" id="mover-coor-modificada" class="validate-me" placeholder="Ej: -12.046, -77.033">
        </div>
      </div>
      <input type="hidden" id="mover-direccion">
    </div>

    <div id="form-campos-comunes">
      <hr class="form-divider">
      <div class="form-row">
        <div class="form-group flex-1">
          <label for="gestion-estado">Estado:</label>
          <select id="gestion-estado">
            <option value="En Cola" selected>En Cola (Por defecto)</option>
            <option value="En Votacion">En Votaci√≥n</option>
          </select>
        </div>
        <div class="form-group flex-1">
          <label for="gestion-nombre">Tu Nick (Wayfarer/PoGo):</label>
          <input type="text" id="gestion-nombre" class="validate-me" placeholder="TuNickAqui">
          <small style="color: #999; display: block; margin-top: 5px;">
            Importante: Esta ser√° tu 'contrase√±a' para editar.
          </small>
        </div>
      </div>
    </div>
    
    <button id="btn-guardar-propuesta" class="primary" style="width: 100%; margin-top: 15px; padding: 12px; font-size: 1.1rem;">
      Subir Propuesta
    </button>
  </div>
</div>

<div class="section-card" id="buscador-card">
  <div class="section-content">
    <div class="form-group" style="margin-bottom: 0;">
      <input type="search" id="gestion-buscador" placeholder="üîé Buscar por t√≠tulo..." style="font-size: 1.1rem;">
    </div>
  </div>
</div>

<div id="gestion-lista-tarjetas">
  </div>

<div id="mapModal" class="modal-map">
  <div class="modal-map-content">
    <h3>Reubicar Propuesta</h3>
    <p>Haz clic en el mapa para seleccionar la nueva ubicaci√≥n (marcador verde).</p>
    
    <div id="map-canvas" style="width: 90vw; max-width: 1000px; height: 70vh; background: #555; border-radius: 12px;">
    </div>
    
    <div class="modal-map-buttons">
      <button id="map-btn-guardar" class="primary">Guardar Ubicaci√≥n</button>
      <button id="map-btn-cancelar" class="poke">Cancelar</button>
    </div>
  </div>
</div>

<!-- ========================================================= -->
<!-- üÜï MODAL EXCLUSIVO PARA MINIATURAS DE MAPA -->
<!-- ========================================================= -->
<div id="mapModalMiniatura" class="modal">
  <div class="modal-content">
    <span id="mapMiniatura-btn-cerrar" class="modal-close">&times;</span>
    <h2>Vista de Ubicaci√≥n</h2>
    <div id="map-canvas-miniatura" style="width:100%; height:400px; border-radius:12px;"></div>
  </div>
</div>


<script>
  setTimeout(() => {
    if (window.initTab2) {
      window.initTab2();
    } else {
      console.error("Error: initTab2 no est√° definido. Aseg√∫rate de que js/tab2_manage.js est√° cargado en index.html.");
    }
  }, 100); 
</script>